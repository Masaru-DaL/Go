# メルカリ作のプログラミング言語Go完全入門 読破
[プログラミング言語Go完全入門](https://tenn.in/go)を読破します。

[A Tour of Go](https://go-tour-jp.appspot.com/welcome/1)を1周しているので、なんとなくは理解している前提で進めます。

# 1. Goに触れる
## 1-1. Goとは？
- **Googleが開発したプログラミング言語**
  - 2022年5月の時点での最新バージョンは`Go1.18`

- 特徴
  - 強力でシンプルな言語設計と文法
  - 並行プログラミング
    - 並列処理が得意という事を目にする事は多い
  - 豊富なライブラリ群
  - 周辺ツールの充実
  - シングルバイナリ
    - 「一つのバイナリ」
  - クロスコンパイル

####　1-1-1. Goが開発された理由
- **Google内の課題を解決する為**に開発された
  - 開発のスケール面
  - 製品のスケール面

#### 1-1-2. Goの開発サイクル
- Goは毎年8月と2月にリリースされる
  - マイナーバージョンのアップ
  - リリース3ヶ月前からDevelopment Freezeになる
    - バグ修正とドキュメント修正以外は基本的に行われない
  - リリース2ヶ月前からベータ版がリリースされる
  - リリース1ヶ月前からRC(Release Candidate: リリース候補)版がリリースされる

#### 1-1-3. Go1の後方互換
- Go1の間は**言語の後方互換が保たれる**
  - セキュリティ、重大バグなどの一部例外はある
  - Go1.0で書いたコードはGo1.18でもビルドできる
    - 場合によっては`go fix`や`go fmt`を掛ける必要がある
  - Go1を対象に執筆された書籍やブログは言語使用に関しては語感が保たれているためGo1.xの間は有効である
    - ランタイムやgo toolに関しては変更される可能性あり

#### 1-1-4. Goの開発プロセスとGo2
- Goの開発プロセス
  - 実際にGoを使った中で問題を見つける
  - 解決策をコミュニティに提案し議論する
  - 実装して評価する
  - 問題なければリリースされる

- Go2とは？
  - Go1.xとして開発していき、Go1の後方互換が保てなくなるような変更を加える必要になったらGo2としてリリースされる
  - 例えば、必ずしもジェネリクスがGo2でリリースされるわけではない
    - ジェネリクスとは
      - Go1.18でリリースされた
      - ジェネリクス(Generics)を利用すると、"型が異なるだけで同じ処理をもつ複数の関数"を"1つの関数"として定義することができる。

#### 1-1-5. 開発版を試す
- `gotip`コマンドを用いる
  - Goは標準で特定のバージョンをインストールできる
  - 使用方法はgoコマンドと同じ(例: `gotip build main.go`)

- The Go Playgroundを用いる
  - 3つのバージョンが選べる(現在, 1つ前, 開発版)

#### 1-1-6. Goの特徴.1
-**強力でシンプルな言語設計と文法**-
- 読みやすい & 書きやすい
  - 複雑な記述をしにくい(愚直に書く)
  - 冗長な記述が不要

- 曖昧さの排除
  - 逆に曖昧な記述はできない

- 考えられたシンプルさ

#### 1-1-7. Goの特徴.2
-**並行プログラミング**-
- ゴールーチン
  - 並列処理の際に用いる
  - **軽量なスレッド**に近いもの
  - 呼び出す関数に`go`を付ける
```go: goroutine
/* 関数fを別のゴールーチンで呼び出す */
go f()
```

- チャネル
  - ゴールーチン間のデータのやり取り
  - **安全にデータをやり取り**できる
[引用: Channel image](https://learnetutorials.com/assets/images/go/channel/image1.png)

#### 1-1-8. Goの特徴.3
-**豊富なライブラリ**-
[標準パッケージ一覧](https://pkg.go.dev/std)

| パッケージ名            | 機能                 |
| ----------------- | ---------------- |
| fmt               | 書式に関する処理など       |
| net/http          | HTTPサーバなど        |
| archive, compress | zipやgzipなど       |
| encoding          | JSON, XML, CSVなど |
| html/template     | HTMLテンプレート       |
| os, path/filepath | ファイル操作など         |

#### 1-1-9. Goの特徴.4
-**周辺ツールの充実**-
- `go <tool名>`で実行可能, 標準/順標準で提供

| ツール名             | 機能                           |
| ---------------- | ---------------------------- |
| go build         | ビルドを行う                       |
|  go test                | `xxxx_test.go`に書かれたテストコードの実行 |
| go doc, godoc    | ドキュメント生成                     |
| gofmt, goimports | コードフォーマッター                   |
| go vet           | コードチェッカー                     |
|  gopls                | Language Server Protocol(LSP)の実装                             |

#### 1-1-10. Goの特徴.5
-**シングルバイナリ・クロスコンパイル**-
- シングルバイナリになる
  - コンパイルするとデフォルトで単一の実行可能ファイルになる
  - 動作環境を特別に用意しなくてもよい
    - デプロイ(別サーバへの配置・実行)が容易になるメリット

- クロスコンパイルできる
  - 開発環境とは違うOSやアーキテクチャ向けのバイナリが作れる
    - 1つのGoプログラムから複数のOS向け(linux, mac, Windows)のバイナリを作成できる
  - 環境変数の`GOOS`と`GOARCH`を指定する
    - GOOS -> OS指定, GOARCH -> CPUの指定
```shell:
# Windows(32ビット)向けにコンパイル
$ GOOS=windows GOARCH=386 go build
# Linux(64ビット)向けにコンパイル
$ GOOS=linux GOARCH=amd64 go build
```

#### 1-1-11. Goに入ってはGoに従え
- **言語だけではなく、文化も学ぶ**
  - ≠Goの慣習に従いなさい
  - 他の言語にも必要な考え方
  - なぜGoが開発されたのかを知ること


## 1-2. Goが利用できる領域
#### 1-2-1. Goの利用状況
- Go開発者向けのアンケート
  - 回答者のうち75%が職場でGoを使用
  - 用途は、API, CLI, Web, DevOpsなど
    - 前年比として傾向は変わっていない

- サーバサイドでの利用
  - HTTPやらそういった用途

#### 1-2-2. gRPCとGo
- gRPC
  - Googleが開発したプロトコルの1つ
  - RPCを実現するために開発された
  - 高速な通信を実現できる

Goではこれが使われているということ。

#### 1-2-3. Google App Engine for Go
- Googleが提供するPaaS(簡単に言うとGoogleの機能を使用する)
  - 高いスケーラビリティ
  - 簡単に利用でき、メンテナンスコストが低い
  - Goのインスタンスの起動は恐ろしく早い！

- Go1.11~ (gVisorベース)
  - Go Modulesが使える
  - ファイルアクセス可能
  - Go1.12から第2世代と呼ばれる
    - App Engine APIが非推奨(サポートされていない)

gVisor? App Engine API? 実体がよく分からない。

#### 1-2-4. Goで開発されている著名なOSS
- クラウン度関連のOSSが多い
  - Docker
  - Kubernetes
    - コンテナを管理する機能を提供する
  - gVisor
    - 調べた感じ、ざっくりとした理解で言うと"プロキシサーバのコンテナ版みたいな感じ"

#### 1-2-5. コマンドラインツールでの利用
- CLIツールの作成に向いている
  - 環境に依存しない点
  - 標準パッケージが豊富な点

#### 1-2-6. 組み込みやIoTでの利用
- 組み込み向け開発にも向いている
  - クロスコンパイル出来る点
  - バイナリサイズが大きくなる問題もある

#### 1-2-7. GopherJSでフロントエンド開発
- Goでフロントエンド開発が出来る、というだけで主流なわけではない

#### 1-2-8. Go Mobileでモバイルアプリ開発
- Goでモバイルアプリ開発が出来る、というだけで主流なわけではない

## 1-3. Goを学ぶには
#### 1-3-1. 怪しい情報に注意しよう
- 無署名な記事は参考にしない

- 1次情報を確認する
  - 事実確認は公式ドキュメントを確認する
  - 1次情報以外は私見が入っている事を意識して読む
  - **日本語で記載された公式のドキュメントはない**

- 記事が多い = 主流な開発手法ではない

#### 1-3-2. 学習教材
- 公式チュートリアル
https://go.dev/doc/tutorial/

- A Tour of Go
https://go.dev/tour

- Shizuoka.go
A Tour of Goを動画で解説
https://shizuoka-go.appspot.com/entry/7b8e7ff0-28e3-4f58-8561-f757f1305913

- Play with Go
Web上でハンズオン可能
https://play-with-go.dev/

- Microsoftが提供するGoのチュートリアル
https://docs.microsoft.com/ja-jp/learn/paths/go-first-steps/
